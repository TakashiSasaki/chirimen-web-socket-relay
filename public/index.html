<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Web Client</title>
	</head>

	<body>
		<h3>Click on the window.</h3>
		<div id="output" style="font-family: Arial; font-size: 14px"></div>

		<script>
			const output = document.getElementById("output");
			output.innerHTML = "Wait for connection...";
			// const ws = new WebSocket("ws://localhost:3000");
			const ws = new WebSocket(
				"wss://chrimen-web-socket-relay.herokuapp.com/token1/token2"
			);
			ws.onopen = function () {
				output.innerHTML = "Connected to the server";
				window.onclick = function (event) {
					const x = event.clientX;
					const y = event.clientY;
					console.log(x + ", " + y);
					ws.send(JSON.stringify({ x: x, y: y }));
				};
				setTimeout(ping, 45 * 1000);

				ws.onmessage = function (event) {
					console.log(event.data);
					const msg = JSON.parse(event.data);
					output.innerHTML = `Answer from server: x = ${msg.x}, y = ${msg.y}`;
				};
			};
			function ping() {
				console.log("ping");
				ws.send("");
				setTimeout(ping, 45 * 1000);
			}
		</script>
	</body>
</html>
